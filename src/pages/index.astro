---
import BaseLayout from '../layouts/BaseLayout.astro';
import Terminal from '../components/Terminal.astro';
import ProjectCard from '../components/ProjectCard.astro';
import BlogCard from '../components/BlogCard.astro';
import { getCollection } from 'astro:content';

// Get featured projects and latest blog posts
const allProjects = await getCollection('projects');
const featuredProjects = allProjects
  .filter(p => p.data.featured)
  .sort((a, b) => a.data.order - b.data.order)
  .slice(0, 3);

const allPosts = await getCollection('blog', ({ data }) => !data.draft);
const latestPosts = allPosts
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);

const techStack = [
  { name: 'TypeScript', color: 'var(--color-accent-cyan)' },
  { name: 'React', color: 'var(--color-accent-cyan)' },
  { name: 'Node.js', color: 'var(--color-accent-emerald)' },
  { name: 'Python', color: 'var(--color-accent-amber)' },
  { name: 'PostgreSQL', color: 'var(--color-accent-cyan)' },
  { name: 'Docker', color: 'var(--color-accent-cyan)' },
  { name: 'AWS', color: 'var(--color-accent-amber)' },
  { name: 'Git', color: 'var(--color-accent-purple)' },
];
---

<BaseLayout title="Home" description="Software Developer passionate about building great products. Explore my projects, read my blog, and learn about my journey.">
  <!-- Hero Section -->
  <section class="relative min-h-[80vh] flex items-center justify-center overflow-hidden">
    <!-- Background Grid Pattern -->
    <div class="absolute inset-0 grid-pattern opacity-30"></div>
    
    <!-- Gradient Orbs -->
    <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-[var(--color-accent-cyan)]/10 rounded-full blur-3xl"></div>
    <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-[var(--color-accent-emerald)]/10 rounded-full blur-3xl"></div>
    
    <div class="relative z-10 max-w-4xl mx-auto px-4 sm:px-6 py-20">
      <!-- Terminal Introduction -->
      <div class="opacity-0 animate-fadeIn">
        <Terminal title="aldy@portfolio:~">
          <div class="space-y-4">
            <p>
              <span class="text-[var(--color-accent-emerald)]">$</span>
              <span class="text-[var(--color-text-primary)]"> whoami</span>
            </p>
            <div class="pl-4">
              <p class="text-[var(--color-text-primary)]">
                <span class="text-[var(--color-accent-cyan)]">Aldy Rambe</span> — Software Developer
              </p>
            </div>
            
            <p>
              <span class="text-[var(--color-accent-emerald)]">$</span>
              <span class="text-[var(--color-text-primary)]"> cat about.txt</span>
            </p>
            <div class="pl-4 text-[var(--color-text-secondary)]">
              <p>Passionate about building elegant solutions to complex problems.</p>
              <p>Crafting performant, accessible, and beautiful web experiences.</p>
              <p>Always learning. Always building. Always curious.</p>
            </div>
            
            <p>
              <span class="text-[var(--color-accent-emerald)]">$</span>
              <span class="text-[var(--color-text-primary)]"> ls ./interests</span>
            </p>
            <div class="pl-4 flex flex-wrap gap-2 text-[var(--color-text-muted)]">
              <span>web-development/</span>
              <span>open-source/</span>
              <span>system-design/</span>
              <span>devops/</span>
            </div>
            
            <p class="flex items-center">
              <span class="text-[var(--color-accent-emerald)]">$</span>
              <span class="text-[var(--color-text-primary)]"> _</span>
              <span class="cursor-blink text-[var(--color-accent-cyan)] ml-1">▋</span>
            </p>
          </div>
        </Terminal>
      </div>
      
      <!-- CTA Buttons -->
      <div class="flex flex-wrap gap-4 mt-8 justify-center opacity-0 animate-fadeIn stagger-2">
        <a 
          href="/projects" 
          class="inline-flex items-center gap-2 px-6 py-3 rounded-lg bg-[var(--color-accent-cyan)] text-[var(--color-bg-primary)] font-mono font-medium hover:bg-[var(--color-accent-emerald)] transition-all duration-200"
        >
          <span>View Projects</span>
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
          </svg>
        </a>
        <a 
          href="/blog" 
          class="inline-flex items-center gap-2 px-6 py-3 rounded-lg border border-[var(--color-border)] text-[var(--color-text-primary)] font-mono hover:border-[var(--color-accent-cyan)] hover:text-[var(--color-accent-cyan)] transition-all duration-200"
        >
          <span>Read Blog</span>
        </a>
      </div>
    </div>
  </section>
  
  <!-- Tech Stack Section -->
  <section class="py-20 bg-[var(--color-bg-secondary)]">
    <div class="max-w-6xl mx-auto px-4 sm:px-6">
      <div class="text-center mb-12">
        <h2 class="font-mono text-sm text-[var(--color-accent-cyan)] mb-2">
          <span class="text-[var(--color-text-muted)]">$</span> cat ./skills.json
        </h2>
        <p class="text-2xl font-bold text-[var(--color-text-primary)]">
          Technologies I Work With
        </p>
      </div>
      
      <div class="flex flex-wrap justify-center gap-4">
        {techStack.map((tech, index) => (
          <div 
            class="group px-5 py-3 rounded-lg border border-[var(--color-border)] bg-[var(--color-bg-card)] hover:border-[var(--color-accent-cyan)] transition-all duration-300 cursor-default"
            style={`animation-delay: ${index * 0.1}s`}
          >
            <span class="font-mono text-[var(--color-text-secondary)] group-hover:text-[var(--color-text-primary)] transition-colors">
              {tech.name}
            </span>
          </div>
        ))}
      </div>
    </div>
  </section>
  
  <!-- Featured Projects Section -->
  <section class="py-20">
    <div class="max-w-6xl mx-auto px-4 sm:px-6">
      <div class="flex items-center justify-between mb-12">
        <div>
          <h2 class="font-mono text-sm text-[var(--color-accent-cyan)] mb-2">
            <span class="text-[var(--color-text-muted)]">$</span> ls ./featured-projects
          </h2>
          <p class="text-2xl font-bold text-[var(--color-text-primary)]">
            Featured Work
          </p>
        </div>
        <a 
          href="/projects"
          class="hidden sm:inline-flex items-center gap-2 text-[var(--color-accent-cyan)] hover:text-[var(--color-accent-emerald)] transition-colors font-mono text-sm"
        >
          View all
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
          </svg>
        </a>
      </div>
      
      {featuredProjects.length > 0 ? (
        <div class="grid md:grid-cols-2 gap-6">
          {featuredProjects.map((project) => (
            <ProjectCard
              title={project.data.title}
              description={project.data.description}
              slug={project.id}
              heroImage={project.data.heroImage}
              technologies={project.data.technologies}
              github={project.data.github}
              live={project.data.live}
              featured={project.data.featured}
            />
          ))}
        </div>
      ) : (
        <div class="text-center py-12">
          <p class="text-[var(--color-text-muted)] font-mono">No featured projects yet. Check back soon!</p>
        </div>
      )}
      
      <div class="sm:hidden text-center mt-8">
        <a 
          href="/projects"
          class="inline-flex items-center gap-2 text-[var(--color-accent-cyan)] hover:text-[var(--color-accent-emerald)] transition-colors font-mono text-sm"
        >
          View all projects
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
          </svg>
        </a>
      </div>
    </div>
  </section>
  
  <!-- Latest Blog Posts Section -->
  <section class="py-20 bg-[var(--color-bg-secondary)]">
    <div class="max-w-6xl mx-auto px-4 sm:px-6">
      <div class="flex items-center justify-between mb-12">
        <div>
          <h2 class="font-mono text-sm text-[var(--color-accent-cyan)] mb-2">
            <span class="text-[var(--color-text-muted)]">$</span> tail -n 3 ./blog.log
          </h2>
          <p class="text-2xl font-bold text-[var(--color-text-primary)]">
            Latest Posts
          </p>
        </div>
        <a 
          href="/blog"
          class="hidden sm:inline-flex items-center gap-2 text-[var(--color-accent-cyan)] hover:text-[var(--color-accent-emerald)] transition-colors font-mono text-sm"
        >
          View all
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
          </svg>
        </a>
      </div>
      
      {latestPosts.length > 0 ? (
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
          {latestPosts.map((post) => (
            <BlogCard
              title={post.data.title}
              description={post.data.description}
              slug={post.id}
              pubDate={post.data.pubDate}
              tags={post.data.tags}
              category={post.data.category}
              heroImage={post.data.heroImage}
            />
          ))}
        </div>
      ) : (
        <div class="text-center py-12">
          <p class="text-[var(--color-text-muted)] font-mono">No blog posts yet. Check back soon!</p>
        </div>
      )}
      
      <div class="sm:hidden text-center mt-8">
        <a 
          href="/blog"
          class="inline-flex items-center gap-2 text-[var(--color-accent-cyan)] hover:text-[var(--color-accent-emerald)] transition-colors font-mono text-sm"
        >
          View all posts
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
          </svg>
        </a>
      </div>
    </div>
  </section>
  
  <!-- Contact CTA Section -->
  <section class="py-20">
    <div class="max-w-3xl mx-auto px-4 sm:px-6 text-center">
      <h2 class="text-3xl sm:text-4xl font-bold text-[var(--color-text-primary)] mb-6">
        Let's Build Something <span class="gradient-text">Together</span>
      </h2>
      <p class="text-[var(--color-text-secondary)] text-lg mb-8">
        Have a project in mind? Want to collaborate? Or just want to say hi?
        I'd love to hear from you.
      </p>
      <a 
        href="mailto:hello@aldyrambe.dev"
        class="inline-flex items-center gap-2 px-8 py-4 rounded-lg bg-[var(--color-accent-cyan)] text-[var(--color-bg-primary)] font-mono font-medium hover:bg-[var(--color-accent-emerald)] transition-all duration-200 text-lg"
      >
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
        </svg>
        Get In Touch
      </a>
    </div>
  </section>
</BaseLayout>
